<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
	<meta charset="UTF-8">
<meta name="apple-mobile-web-app-title" content="Git常用命令及工作流梳理">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-touch-fullscreen" content="yes">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="format-detection" content="telephone=no">
<meta name="format-detection" content="email=no">
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<link rel="stylesheet" href="/blog/stylesheets/normalize.css">
<link rel="stylesheet" href="/blog/stylesheets/base.css">
<link rel="stylesheet" href="/blog/stylesheets/monokai.css">
<script src="/blog/javascripts/base.js"></script>
<title>Git常用命令及工作流梳理</title>
</head>
<body>
	<div class="j-container-fluid j-header">
	<div class="j-row">
		<div class="j-container">
			<h1 class="j-logo"><a href="/blog/"><img src="/blog/images/logo.png" /> </a></h1>
			<nav class="j-row j-nav">
				<a href="/blog/">首页</a>
				<a href="/blog/list.html">归档</a>
				<a href="https://github.com/Yi-love">Github</a>
				<a href="/blog/me.html">Me</a>
				<a href="http://blog.csdn.net/yjy188" target="_blank">CSDN</a>
			</nav>
		</div>
	</div>
</div>
	<div class="j-container">
		<div class="j-row">
			<div class="j-col-xs-12 j-col-sm-12 j-col-md-9">
				<div class="j-container j-content">
					<h2 class="j-i-title"><a href="javascript:void(0)" title="Git常用命令及工作流梳理">Git常用命令及工作流梳理</a></h2>
						<p class="j-i-time">04 Apr 2016</p>
						<p class="j-i-tags">
							
							<span class="j-i-tag">git命令</span>
							
							<span class="j-i-tag">工作流</span>
							
							<span class="j-i-tag">分支处理</span>
							
						</p>
						<div class="j-container">
							<div class="j-row j-artclie-txt"><p>虽然使用github也有一段时间了，可是对于git的代码管理策略还是模糊不清，所以特地的花了几个小时来使用git，熟悉和理解git。</p>

<h3 id="git-">1. Git 常用命令</h3>

<h4 id="section">1.1 新建分支</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  <span class="nv">$ </span>git branch 新分支名	
  <span class="c">#新建分支 develop</span>
  <span class="nv">$ </span>git branch develop<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-1">1.2 分支切换</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  <span class="nv">$ </span>git checkout 分支名	
  <span class="c">#切换到分支 develop</span>
  <span class="nv">$ </span>git checkout develop<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-2">1.3 新增分支并切换到分支</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  <span class="nv">$ </span>git branch -b 新建分支名
  <span class="c">#新开 develop 分支，并切换到此分支</span>
  <span class="nv">$ </span>git checkout -b develop<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-3">1.4 查看分支</h4>
<blockquote>
  <p>-a ： 头带remotes/origin为远程分支</p>
</blockquote>

<blockquote>
  <p>-r : 远程分支</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="nv">$ </span>git branch -a | -r	<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-4">1.5 向远程仓库提交分支</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  <span class="nv">$ </span>git push origin 新建分支名
  <span class="c">#提交新建的 develop 分支</span>
  <span class="nv">$ </span>git push origin develop<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-5">1.6 分支合并</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="nv">$ </span>git merge 分支<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-6">1.7 分支删除</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="nv">$ </span>git branch -d 分支名<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-7">1.8 分支删除</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>  <span class="nv">$ </span>git branch -d 本地分支名
  <span class="nv">$ </span>git push origin --delete 远程分支名<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-8">1.9 更新分支信息</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="nv">$ </span>git fetch -p 更新分支信息<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-9">1.10 拉起远程仓库合并到本地分支</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="nv">$ </span>git pull 分支<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="git">2.工作时常用的Git命令</h3>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  <span class="nv">$ </span>git add <span class="o">[</span>filename] 添加文件
  <span class="nv">$ </span>git commit -m <span class="s1">'desc'</span> 提交到缓存区
  <span class="nv">$ </span>git push origin <span class="o">[</span>branchname] 提交修改到远程分支<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="git-1">3.Git工作流</h3>
<blockquote>
  <p>本文的三种工作流程，有一个共同点：都采用”功能驱动式开发”（Feature-driven development，简称FDD）。
它指的是，需求是开发的起点，先有需求再有功能分支（feature branch）或者补丁分支（hotfix branch）。完成开发后，该分支就合并到主分支，然后被删除。</p>
</blockquote>

<h4 id="git-flow">3.1 Git flow工作流</h4>
<blockquote>
  <p>特点：首先，项目存在两个长期分支。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>  主分支master
  开发分支develop<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>前者用于存放对外发布的版本，任何时候在这个分支拿到的，都是稳定的分布版；后者用于日常开发，存放最新的开发版。</p>
</blockquote>

<p><img src="/blog/images/2016/0404_03.jpg" alt="git" /></p>

<blockquote>
  <p>其次，项目存在三种短期分支。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>   功能分支（feature branch）
   补丁分支（hotfix branch）
   预发分支（release branch）<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>一旦完成开发，它们就会被合并进develop或master，然后被删除。</p>
</blockquote>

<blockquote>
  <p>总结：优点：清晰可控；缺点：缺少相对复杂。</p>
</blockquote>

<h4 id="github-flow">3.2 Github flow工作流</h4>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">第一步：根据需求，从master拉出新分支，不区分功能分支或补丁分支。
第二步：新分支开发完成后，或者需要讨论的时候，就向master发起一个pull request（简称PR）。
第三步：Pull Request既是一个通知，让别人注意到你的请求，又是一种对话机制，大家一起评审和讨论你的代码。
   对话过程中，你还可以不断提交代码。
第四步：你的Pull Request被接受，合并进master，重新部署后，原来你拉出来的那个分支就被删除。
   （先部署再合并也可。）</code></pre></figure>

<p><img src="/blog/images/2016/0404_04.jpg" alt="git" /></p>

<blockquote>
  <p>总结：优点就是简单，对于”持续发布”的产品，可以说是最合适的流程，缺点：缺少版本控制。</p>
</blockquote>

<h4 id="gitlab-flow">3.3 GitLab flow工作流</h4>
<blockquote>
  <p>Gitlab flow 是 Git flow 与 Github flow 的综合。它吸取了两者的优点，既有适应不同开发环境的弹性，又有单一主分支的简单和便利。它是 Gitlab.com 推荐的做法。</p>
</blockquote>

<p><img src="/blog/images/2016/0404_02.jpg" alt="git" /></p>

<h3 id="section-10">4.技巧</h3>

<h4 id="pull-requests">4.1 Pull Requests</h4>

<blockquote>
  <p>Pull requests是Bitbucket提供的让开发者更方便地进行协作的功能，提供了友好的Web界面可以在提议的修改合并到正式项目之前对修改进行讨论。</p>
</blockquote>

<h4 id="issue">4.2 Issue</h4>
<blockquote>
  <p>Issue 用于 Bug追踪和需求管理。建议先新建 Issue，再新建对应的功能分支。功能分支总是为了解决一个或多个 Issue。
功能分支的名称，可以与issue的名字保持一致，并且以issue的编号起首，比如”1-add-git.md”。
开发完成后，在提交说明里面，可以写上”fixes #1”或者”closes #1”。Github规定，只要commit message里面有下面这些动词 + 编号，就会关闭对应的issue。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">	close
	closes
	closed
	fix
	fixes
	fixed
	resolve
	resolves
	resolved</code></pre></figure>

<p>这种方式还可以一次关闭多个issue，或者关闭其他代码库的issue，格式是username/repository#issue_number。</p>

<p>Pull Request被接受以后，issue关闭，原始分支就应该删除。如果以后该issue重新打开，新分支可以复用原来的名字。</p>

<h4 id="merge">4.3 Merge分支合并</h4>
<blockquote>
  <p>Git有两种合并：一种是”直进式合并”（fast forward），不生成单独的合并节点；另一种是”非直进式合并”（none fast-forword），会生成单独节点。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>  <span class="nv">$ </span>git merge 分支名  <span class="c">#直进式合并</span>
  <span class="nv">$ </span>git merge --no-ff 分支名   <span class="c">#非直进式合并</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="section-11">参考资料：</h3>
<p><a href="https://www.atlassian.com/git/tutorials/comparing-workflows/">英文资料</a></p>

<p><a href="http://www.ruanyifeng.com/blog/2015/12/git-workflow.html?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">Git 工作流程-阮一峰</a></p>

<p><a href="https://github.com/oldratlee/translations/tree/master/git-workflows-and-tutorials?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">Git工作流指南</a></p>

<p><a href="http://jonyfang.com/blog/2015/11/12/git_command_and_git_branching_model/?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">Git 常用命令和 Git Flow 梳理</a></p>

<p><a href="http://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a></p>

<p><img src="/blog/images/2016/0404_01.png" alt="git" /></p>

</div>
						</div>
				</div>
			</div>
			<div class="j-col-xs-12 j-col-sm-12 j-col-md-3">
	<div class="j-user">
		<div class="j-user-thumb">
			<a href="/blog/me.html"><img src="/blog/images/user.jpg" alt="" /></a>
		</div>
		<div class="j-user-info">
			<a href="/blog/me.html">微信</a>
			<a href="/blog/me.html">微博</a>
			<a href="/blog/me.html">QQ</a>
		</div>
	</div>
	<div class="j-class-list">
		<h3 class="j-row">分类</h3>
		
		<a href="/blog/category.html?category=笔记">笔记 <span class="j-class-i-num">(15)</span></a>
		
		<a href="/blog/category.html?category=JavaScript">JavaScript <span class="j-class-i-num">(10)</span></a>
		
		<a href="/blog/category.html?category=bee.js">bee.js <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=Promise">Promise <span class="j-class-i-num">(3)</span></a>
		
		<a href="/blog/category.html?category=工具">工具 <span class="j-class-i-num">(3)</span></a>
		
		<a href="/blog/category.html?category=Git">Git <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=vim">vim <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=gulp">gulp <span class="j-class-i-num">(1)</span></a>
		
	</div>
</div>
		</div>
	</div>
	<div class="j-container-fluid j-footer">
	<div class="j-container">
		<p class="j-footer-say">喜欢一个人需要理由吗？需要吗？不需要吗？需要吗？……</p>
		<p class="j-footer-say j-tlgr">——周星驰 《大话西游》</p>
	</div>
</div>

</body>
</html>