<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
	<meta charset="UTF-8">
<meta name="apple-mobile-web-app-title" content="原生JavaScript编写的查看大图组件">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-touch-fullscreen" content="yes">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="format-detection" content="telephone=no">
<meta name="format-detection" content="email=no">
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<link rel="stylesheet" href="/blog/stylesheets/normalize.css">
<link rel="stylesheet" href="/blog/stylesheets/base.css">
<link rel="stylesheet" href="/blog/stylesheets/monokai.css">
<script src="/blog/javascripts/base.js"></script>
<title>原生JavaScript编写的查看大图组件</title>
</head>
<body>
	<div class="j-container-fluid j-header">
	<div class="j-row">
		<div class="j-container">
			<h1 class="j-logo"><a href="/blog/"><img src="/blog/images/logo.png" /> </a></h1>
			<nav class="j-row j-nav">
				<a href="/blog/">首页</a>
				<a href="/blog/list.html">归档</a>
				<a href="https://github.com/Yi-love">Github</a>
				<a href="/blog/me.html">Me</a>
				<a href="http://blog.csdn.net/yjy188" target="_blank">CSDN</a>
			</nav>
		</div>
	</div>
</div>
	<div class="j-container">
		<div class="j-row">
			<div class="j-col-xs-12 j-col-sm-12 j-col-md-9">
				<div class="j-container j-content">
					<h2 class="j-i-title"><a href="javascript:void(0)" title="原生JavaScript编写的查看大图组件">原生JavaScript编写的查看大图组件</a></h2>
						<p class="j-i-time">23 Mar 2016</p>
						<p class="j-i-tags">
							
							<span class="j-i-tag">JavaScript</span>
							
							<span class="j-i-tag">组件</span>
							
							<span class="j-i-tag">兼容</span>
							
						</p>
						<div class="j-container">
							<div class="j-row j-artclie-txt"><blockquote>
  <p>最近接手了一个商城项目，所以自己写了一个商品详情页面浏览商品大图的组件。虽然可能背负上重复造轮子的骂名。但我还是觉得有必要写的。
这起码也是自己的一个实践过程。兼容方面考虑到兼容IE8+,所以很多的代码都是在做兼容。</p>
</blockquote>

<blockquote>
  <h3 id="section">知识点</h3>
</blockquote>

<blockquote>
  <h4 id="css">1.css设置兼容</h4>
  <p>ie8是不支持style来设置属性的。但ie8支持存在runtimeStyle属性对象。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="cm">/**
* 设置元素样式属性
* @param {Object} element 元素
* @param {Object} props   属性对象
*/</span>
<span class="kd">function</span> <span class="nx">setCss</span><span class="p">(</span><span class="nx">element</span> <span class="p">,</span> <span class="nx">props</span><span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">style</span> <span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span>  <span class="nx">props</span> <span class="p">)</span> <span class="p">{</span>
	  <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
    <span class="p">};</span>
  <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">){</span><span class="c1">//ie8</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span>  <span class="nx">props</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<blockquote>
  <h4 id="section-1">2.事件监听</h4>
  <p>事件监听ie8也是与正常的添加事件监听不同，所以需要使用attachEvent来处理事件监听。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="cm">/**
 * 事件监听
 * @param {Object} element 元素
 * @param {Object} type    类型
 * @param {Object} fn      回调函数
 */</span>
<span class="kd">function</span> <span class="nx">addEvent</span><span class="p">(</span><span class="nx">element</span> <span class="p">,</span> <span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="p">){</span><span class="c1">//w3c</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span> <span class="p">){</span><span class="c1">//ie8</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">'on'</span><span class="o">+</span><span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="c1">//其他</span>
    <span class="nx">element</span><span class="p">[</span><span class="s1">'on'</span><span class="o">+</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<blockquote>
  <h4 id="section-2">3.获取元素相对于页面的左边距和上边距的距离</h4>
  <p>因为无法立即获得这个距离，所以只能通过遍历元素到body之间所有的元素的上边距或左边距进行选取最大值。
才可以获取得到最后元素距离页面左边距和上边距的距离。</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">//获取距离距离top和left的距离</span>
<span class="kd">function</span> <span class="nx">getOffset</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span> <span class="nx">element</span> <span class="o">!=</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">element</span> <span class="o">!=</span> <span class="nb">document</span> <span class="p">){</span>
      <span class="nx">top</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="p">,</span> <span class="nx">top</span><span class="p">);</span>
      <span class="nx">left</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetLeft</span> <span class="p">,</span> <span class="nx">left</span><span class="p">);</span>
      <span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span><span class="na">left</span><span class="p">:</span><span class="nx">left</span> <span class="p">,</span> <span class="na">top</span><span class="p">:</span><span class="nx">top</span><span class="p">};</span>
<span class="p">};</span></code></pre></figure>

<blockquote>
  <h4 id="section-3">4.滚动距离</h4>
  <p>获取滚动条滚动的距离，这里主要的也是兼容问题。</p>
</blockquote>

<blockquote>
  <p>IE Firefox Opera 标准模式下使用 document.documentElement.scrollLeft;</p>
</blockquote>

<blockquote>
  <p>获取页面的水平滚动条位置，而混杂模式下则是使用 document.body.scrollLeft。</p>
</blockquote>

<blockquote>
  <p>Chrome Safari 在两种文档模式下均使用 document.body.scrollLeft 获取页面的水平滚动条位置。</p>
</blockquote>

<blockquote>
  <p>In IE 6 standards compatibility mode (where document.compatMode == “CSS1Compat”), 
use <em>document.body.parentNode.scrollLeft</em> and <em>document.body.parentNode.scrollTop</em> to get the scroll values of the html element.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">//获取屏幕滚动距离</span>
<span class="kd">function</span> <span class="nx">getScrollXY</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">x</span> <span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollX</span>  <span class="o">||</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span>
    <span class="na">y</span> <span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span> 
        <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span>
  <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<h3 id="section-4">全部源码</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
	<span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'body'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
	<span class="c1">//对象</span>
	<span class="kd">function</span> <span class="nx">Blow</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">blowbox</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">blowbox</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">cursor</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">cursor</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">blowmax</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">blowmax</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">maxbox</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">maxbox</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">blowsmall</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">blowsmall</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">max</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">pst</span> <span class="o">=</span> <span class="p">{};</span>
	<span class="p">};</span>
	<span class="c1">//初始化</span>
	<span class="nx">Blow</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
		<span class="kd">var</span> <span class="nx">blowmax</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blowmax</span> <span class="p">,</span>
			<span class="nx">blowbox</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blowbox</span><span class="p">,</span>
			<span class="nx">cursor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cursor</span><span class="p">,</span>
			<span class="nx">max</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">max</span> <span class="p">,</span> 
			<span class="nx">blowsmall</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blowsmall</span><span class="p">,</span>
			<span class="nx">maxbox</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxbox</span><span class="p">,</span>
			<span class="nx">pst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pst</span><span class="p">;</span>
		
		<span class="nx">setCss</span><span class="p">(</span><span class="nx">blowmax</span> <span class="p">,</span> <span class="p">{</span><span class="na">width</span> <span class="p">:</span> <span class="nx">max</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="s1">'px'</span> <span class="p">,</span> <span class="na">height</span><span class="p">:</span><span class="nx">max</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="s1">'px'</span><span class="p">});</span>
		<span class="nx">addEvent</span><span class="p">(</span><span class="nx">blowbox</span> <span class="p">,</span> <span class="s1">'mousemove'</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
			<span class="nx">setCss</span><span class="p">(</span><span class="nx">maxbox</span> <span class="p">,</span> <span class="p">{</span><span class="na">display</span><span class="p">:</span> <span class="s1">'block'</span><span class="p">});</span>
			<span class="nx">pst</span> <span class="o">=</span> <span class="nx">getPosition</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">max</span> <span class="p">,</span> <span class="nx">blowbox</span><span class="p">);</span>
			<span class="nx">setCss</span><span class="p">(</span><span class="nx">cursor</span> <span class="p">,</span> <span class="p">{</span><span class="na">top</span> <span class="p">:</span> <span class="nx">pst</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="s1">'px'</span> <span class="p">,</span> <span class="na">left</span><span class="p">:</span><span class="nx">pst</span><span class="p">.</span><span class="nx">left</span><span class="o">+</span><span class="s1">'px'</span><span class="p">});</span>
			<span class="nx">showMax</span><span class="p">(</span><span class="nx">pst</span> <span class="p">,</span> <span class="nx">blowmax</span><span class="p">);</span>
		<span class="p">});</span>	
		<span class="nx">addEvent</span><span class="p">(</span><span class="nx">blowbox</span><span class="p">,</span> <span class="s1">'mouseout'</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
			<span class="nx">setCss</span><span class="p">(</span><span class="nx">maxbox</span> <span class="p">,</span> <span class="p">{</span><span class="na">display</span><span class="p">:</span> <span class="s1">'none'</span><span class="p">});</span>
		<span class="p">});</span>
		
	<span class="p">};</span>
	<span class="cm">/**
	 * 事件监听
	 * @param {Object} element 元素
	 * @param {Object} type    类型
	 * @param {Object} fn      回调函数
	 */</span>
	<span class="kd">function</span> <span class="nx">addEvent</span><span class="p">(</span><span class="nx">element</span> <span class="p">,</span> <span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="p">){</span>
			<span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
		<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span> <span class="p">){</span>
			<span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">'on'</span><span class="o">+</span><span class="nx">type</span> <span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
			<span class="nx">element</span><span class="p">[</span><span class="s1">'on'</span><span class="o">+</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="cm">/**
	 * 设置元素样式属性
	 * @param {Object} element 元素
	 * @param {Object} props   属性对象
	 */</span>
	<span class="kd">function</span> <span class="nx">setCss</span><span class="p">(</span><span class="nx">element</span> <span class="p">,</span> <span class="nx">props</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">style</span> <span class="p">){</span>
			<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span>  <span class="nx">props</span> <span class="p">)</span> <span class="p">{</span>
				<span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
			<span class="p">};</span>
		<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">){</span>
			<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span>  <span class="nx">props</span> <span class="p">)</span> <span class="p">{</span>
				<span class="nx">element</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
			<span class="p">};</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="c1">//获取位置</span>
	<span class="kd">function</span> <span class="nx">getPosition</span><span class="p">(</span><span class="nx">e</span> <span class="p">,</span> <span class="nx">max</span> <span class="p">,</span> <span class="nx">blowbox</span><span class="p">){</span>
		<span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">getOffset</span><span class="p">(</span><span class="nx">blowbox</span><span class="p">)</span> <span class="p">,</span> 
			<span class="nx">xy</span> <span class="o">=</span> <span class="nx">getScrollXY</span><span class="p">();</span>
		<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="o">+</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="o">-</span><span class="nx">offset</span><span class="p">.</span><span class="nx">left</span><span class="o">+</span><span class="nx">xy</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="p">,</span> 
			<span class="nx">y</span> <span class="o">=</span> <span class="o">+</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="o">-</span><span class="nx">offset</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="nx">xy</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span><span class="o">-</span><span class="nx">max</span><span class="o">*</span><span class="mf">0.25</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">x</span><span class="o">-</span><span class="nx">max</span><span class="o">*</span><span class="mf">0.25</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">,</span> 
			<span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span><span class="o">-</span><span class="nx">max</span><span class="o">*</span><span class="mf">0.25</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">y</span><span class="o">-</span><span class="nx">max</span><span class="o">*</span><span class="mf">0.25</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
			
		<span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">?</span> <span class="nx">max</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">:</span> <span class="nx">left</span> <span class="p">;</span>
		<span class="nx">top</span> <span class="o">=</span> <span class="nx">top</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">?</span> <span class="nx">max</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">:</span> <span class="nx">top</span> <span class="p">;</span>
		
		<span class="k">return</span> <span class="p">{</span><span class="na">left</span><span class="p">:</span><span class="nx">left</span> <span class="p">,</span><span class="na">top</span><span class="p">:</span><span class="nx">top</span><span class="p">};</span>
	<span class="p">};</span>
	<span class="c1">//展示大图</span>
	<span class="kd">function</span> <span class="nx">showMax</span><span class="p">(</span><span class="nx">pst</span> <span class="p">,</span> <span class="nx">blowmax</span><span class="p">){</span>
		<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">pst</span><span class="p">.</span><span class="nx">left</span><span class="o">*</span><span class="mi">2</span> <span class="p">,</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">pst</span><span class="p">.</span><span class="nx">top</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span> <span class="nx">blowmax</span><span class="p">.</span><span class="nx">style</span> <span class="p">){</span>
			<span class="nx">blowmax</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginLeft</span> <span class="o">=</span> <span class="o">-</span><span class="nx">x</span> <span class="o">+</span><span class="s1">'px'</span><span class="p">;</span>
			<span class="nx">blowmax</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginTop</span> <span class="o">=</span> <span class="o">-</span><span class="nx">y</span><span class="o">+</span><span class="s1">'px'</span><span class="p">;</span>
		<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="nx">blowmax</span><span class="p">.</span><span class="nx">runtimeStyle</span> <span class="p">){</span>
			<span class="nx">blowmax</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">.</span><span class="nx">marginLeft</span> <span class="o">=</span> <span class="o">-</span><span class="nx">x</span> <span class="o">+</span><span class="s1">'px'</span><span class="p">;</span>
			<span class="nx">blowmax</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">.</span><span class="nx">marginTop</span> <span class="o">=</span> <span class="o">-</span><span class="nx">y</span><span class="o">+</span><span class="s1">'px'</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="c1">//获取距离距离top和left的距离</span>
	<span class="kd">function</span> <span class="nx">getOffset</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
		<span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">while</span> <span class="p">(</span> <span class="nx">element</span> <span class="o">!=</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">element</span> <span class="o">!=</span> <span class="nb">document</span> <span class="p">){</span>
				<span class="nx">top</span> <span class="o">=</span> <span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">&gt;</span> <span class="nx">top</span> <span class="p">?</span> <span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="p">:</span> <span class="nx">top</span><span class="p">;</span>
				<span class="nx">left</span> <span class="o">=</span> <span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetLeft</span> <span class="o">&gt;</span> <span class="nx">left</span> <span class="p">?</span> <span class="o">+</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetLeft</span> <span class="p">:</span> <span class="nx">left</span><span class="p">;</span>
				<span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="p">{</span><span class="na">left</span><span class="p">:</span><span class="nx">left</span> <span class="p">,</span> <span class="na">top</span><span class="p">:</span><span class="nx">top</span><span class="p">};</span>
	<span class="p">};</span>
	<span class="c1">//获取屏幕滚动距离</span>
	<span class="kd">function</span> <span class="nx">getScrollXY</span><span class="p">(){</span>
		<span class="k">return</span> <span class="p">{</span>
			<span class="na">x</span> <span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollX</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span>
			<span class="na">y</span> <span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="k">return</span> <span class="p">{</span>
		<span class="na">run</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
			<span class="k">return</span> <span class="k">new</span> <span class="nx">Blow</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">init</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">})();</span></code></pre></figure>

<h3 id="section-5">调用方式</h3>

<figure class="highlight"><pre><code class="language-html" data-lang="html">//index.html
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;</span>查看大图<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"blow.css"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-box"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-small-box"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-content-box"</span> <span class="na">id=</span><span class="s">"j_blow_box"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-img-box"</span><span class="nt">&gt;</span>
						<span class="nt">&lt;img</span> <span class="na">class=</span><span class="s">"blow-small-img"</span> <span class="na">id=</span><span class="s">"j_blow_small"</span> <span class="na">src=</span><span class="s">"images/small.jpg"</span><span class="nt">/&gt;</span>
					<span class="nt">&lt;/div&gt;</span>
					<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"blow-img-cursor"</span> <span class="na">id=</span><span class="s">"j_blow_cursor"</span><span class="nt">&gt;&lt;/span&gt;</span>
				<span class="nt">&lt;/div&gt;</span>
				<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-small-bar"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"blow-small-list"</span><span class="nt">&gt;</span>
						<span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"blow-small-list-i"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"images/small.jpg"</span><span class="nt">/&gt;&lt;/li&gt;</span>
						<span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"blow-small-list-i"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"images/small.jpg"</span><span class="nt">/&gt;&lt;/li&gt;</span>
						<span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"blow-small-list-i"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"images/small.jpg"</span><span class="nt">/&gt;&lt;/li&gt;</span>
						<span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"blow-small-list-i"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"images/small.jpg"</span><span class="nt">/&gt;&lt;/li&gt;</span>
					<span class="nt">&lt;/ul&gt;</span>
				<span class="nt">&lt;/div&gt;</span>
			<span class="nt">&lt;/div&gt;</span>
			<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"blow-max-box"</span> <span class="na">id=</span><span class="s">"j_blow_max_box"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"images/max.jpg"</span> <span class="na">id=</span><span class="s">"j_blow_max"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
	<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"blow.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
	<span class="nt">&lt;script&gt;</span>
	 	<span class="c1">//手势</span>
	<span class="kd">var</span>	<span class="nx">cursor</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'j_blow_cursor'</span><span class="p">),</span>
		<span class="c1">//小图</span>
		<span class="nx">blowsmall</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'j_blow_small'</span><span class="p">),</span>
		<span class="c1">//大图</span>
		<span class="nx">blowmax</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'j_blow_max'</span><span class="p">),</span>
		<span class="c1">//大图box</span>
		<span class="nx">maxbox</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'j_blow_max_box'</span><span class="p">),</span>
		<span class="c1">//小图box</span>
		<span class="nx">blowbox</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'j_blow_box'</span><span class="p">);</span>
	
	<span class="c1">//运行</span>
	<span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">run</span><span class="p">({</span>
		<span class="na">blowbox</span> <span class="p">:</span><span class="nx">blowbox</span><span class="p">,</span>
		<span class="na">cursor</span> <span class="p">:</span> <span class="nx">cursor</span><span class="p">,</span>
		<span class="na">blowmax</span> <span class="p">:</span> <span class="nx">blowmax</span><span class="p">,</span>
		<span class="na">maxbox</span> <span class="p">:</span> <span class="nx">maxbox</span><span class="p">,</span>
		<span class="na">blowsmall</span> <span class="p">:</span> <span class="nx">blowsmall</span><span class="p">,</span>
		<span class="na">max</span> <span class="p">:</span> <span class="mi">464</span><span class="c1">//大图大小</span>
	<span class="p">})</span>
	<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h4 id="css-1">css代码如下：</h4>

<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.blow-box</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">574px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
	<span class="nl">margin-left</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span>
	<span class="nl">margin-top</span><span class="p">:</span> <span class="m">400px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-small-box</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-max-box</span><span class="p">{</span>
	<span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
	<span class="nl">z-index</span><span class="p">:</span> <span class="m">99</span><span class="p">;</span>
	<span class="nl">right</span><span class="p">:</span> <span class="m">-464px</span><span class="p">;</span>
	<span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-content-box</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-small-bar</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">110px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-small-list</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">82px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
	<span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-small-list</span> <span class="nc">.blow-small-list-i</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">78px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">78px</span><span class="p">;</span>
	<span class="nl">margin</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
	<span class="nl">border</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="m">#47baac</span><span class="p">;</span>
	<span class="nl">list-style</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
	<span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
	<span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-small-list</span> <span class="nc">.blow-small-list-i</span> <span class="nt">img</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">78px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">78px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-content-box</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
	<span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-img-box</span> <span class="o">,</span> <span class="nc">.blow-small-img</span><span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">464px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-img-cursor</span><span class="p">{</span>
	<span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
	<span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
	<span class="nl">z-index</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
	<span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
	<span class="nl">left</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">232px</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">232px</span><span class="p">;</span>
	<span class="nl">cursor</span><span class="p">:</span> <span class="n">move</span><span class="p">;</span>
	<span class="nl">background</span><span class="p">:</span> <span class="sx">url(images/blow.png)</span> <span class="nb">repeat</span> <span class="nb">transparent</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.blow-content-box</span><span class="nd">:hover</span> <span class="nc">.blow-img-cursor</span><span class="p">{</span>
	<span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<blockquote>
  <h3 id="section-6">案例</h3>
</blockquote>

<p><a href="/blog/examples/blow/index.html">案例演示</a></p>
</div>
						</div>
				</div>
			</div>
			<div class="j-col-xs-12 j-col-sm-12 j-col-md-3">
	<div class="j-user">
		<div class="j-user-thumb">
			<a href="/blog/me.html"><img src="/blog/images/user.jpg" alt="" /></a>
		</div>
		<div class="j-user-name"><h3>Jin</h3></div>
		<div class="j-user-info">
			<a href="/blog/me.html">微信</a>
			<a href="/blog/me.html">微博</a>
			<a href="/blog/me.html">QQ</a>
		</div>
	</div>
	<div class="j-class-list">
		<h3 class="j-row">分类</h3>
		
		<a href="/blog/category.html?category=笔记">笔记 <span class="j-class-i-num">(19)</span></a>
		
		<a href="/blog/category.html?category=JavaScript">JavaScript <span class="j-class-i-num">(12)</span></a>
		
		<a href="/blog/category.html?category=bee.js">bee.js <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=Promise">Promise <span class="j-class-i-num">(3)</span></a>
		
		<a href="/blog/category.html?category=工具">工具 <span class="j-class-i-num">(3)</span></a>
		
		<a href="/blog/category.html?category=Git">Git <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=vim">vim <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=gulp">gulp <span class="j-class-i-num">(1)</span></a>
		
		<a href="/blog/category.html?category=Node">Node <span class="j-class-i-num">(2)</span></a>
		
		<a href="/blog/category.html?category=IE兼容">IE兼容 <span class="j-class-i-num">(2)</span></a>
		
		<a href="/blog/category.html?category=CSS">CSS <span class="j-class-i-num">(2)</span></a>
		
	</div>
</div>
		</div>
	</div>
	<div class="j-container-fluid j-footer">
	<div class="j-container">
		<p class="j-footer-say">喜欢一个人需要理由吗？需要吗？不需要吗？需要吗？……</p>
		<p class="j-footer-say j-tlgr">——周星驰 《大话西游》</p>
	</div>
</div>
<div class="j-tips-box">
	<div class="j-tips-max-box" onclick="fullScreen()">
		<span class="l-t"></span>
		<span class="r-t"></span>
		<span class="l-b"></span>
		<span class="r-b"></span>
	</div>
	<div class="j-tips-top-box">
		<a href="javascript:window.scrollTo(0,0)" class="j-tip-top"><span class="l-bar"></span><span class="r-bar"></span></a>
	</div>
</div>
</body>
</html>